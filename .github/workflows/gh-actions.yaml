name: Enviar os arquivos para o servidor.
run-name:  Realizar esse envio a cada mudança do site.
on: [push]
jobs:
  Entra-no-Servidor:
    runs-on: ubuntu-22.04
    concurrency:
      group: ${{ github.workflow }}-${{ github.ref }}
    steps:
      - name: Clonar o repositório para montar os arquivos HTML.
        uses: actions/checkout@master
        with:
          submodules: true
      - name: Hugo Framework - Montagem dos arquivos estáticos.
        uses: peaceiris/actions-hugo@v3
        with:
          hugo-version: '0.134.2'
          extended: true
      - name: Construção das páginas
        run: hugo --minify
      - name: Transfere os arquivos criados para o servidor.
        uses: easingthemes/ssh-deploy@v5.1.0
        with: 
            SSH_PRIVATE_KEY: ${{ secrets.SSHKEY }}
            REMOTE_USER: ${{ secrets.SSHUSER }}
            REMOTE_HOST: ${{ secrets.SSHHOST }}
            REMOTE_PORT: ${{ secrets.SSHPORT }}
            SOURCE: "public/"
            TARGET: "${{ secrets.PATHDESIGN }}"
            ARGS: '--include .htaccess --exclude ".*" --recursive --delete-excluded' 